import{s as g}from"./three.module.493739a3.js";import{d as S,t as d,b as a,E as e}from"./avatarFunctions.6d66cf01.js";import{I as y,L as x,X as v,g as E,a as i,B as m,b as n}from"./[projectId].a008d20c.js";import{a as b}from"./addControllerModels.14512c2e.js";import{e as R,s as j}from"./WebXRFunctions.87bd8924.js";import"./index.7b02be28.js";import"./vendor.475cb2ff.js";import"./_app.f0a72417.js";import"./AuthService.e8999ddc.js";import"./AlertService.5d8abaff.js";import"./feathers.32f4d4e8.js";import"./SystemUpdateType.772fc25d.js";import"./upload.bd537b46.js";import"./index.81138b53.js";import"./XRHandsInputComponent.3d76e9a2.js";async function W(h){const p="local-floor",u=S([y,x,v]);return await d.loadAsync({url:"/models/webxr/controllers/valve_controller_knu_1_0_right.glb"}),await d.loadAsync({url:"/models/webxr/controllers/hands/left.glb"}),await d.loadAsync({url:"/models/webxr/controllers/hands/right.glb"}),a.instance.addEventListener(a.EVENTS.XR_START,async r=>{e.renderer.outputEncoding=g;const t={optionalFeatures:[p,"hand-tracking"]};try{const s=await navigator.xr.requestSession("immersive-vr",t);e.xrSession=s,e.xrRenderer.setReferenceSpaceType(p),e.xrRenderer.setSession(s),a.instance.dispatchEvent({type:a.EVENTS.XR_SESSION}),e.xrRenderer.getCamera().layers.enableAll(),e.xrRenderer.addEventListener("sessionend",async()=>{R(),a.instance.dispatchEvent({type:a.EVENTS.XR_END})}),j()}catch(s){console.log("Failed to create XR Session",s)}}),()=>{if(e.xrRenderer?.isPresenting){const r=e.xrFrame.session;for(const t of r.inputSources)if(t.gamepad){const s=E[t.gamepad.mapping||"xr-standard"][t.handedness];t.gamepad?.buttons.forEach((o,l)=>{const c=e.prevInputState.get(s.buttons[l]);if(!c&&o.pressed==!1)return;const f=c?.value&&o.pressed;e.inputState.set(s.buttons[l],{type:i.BUTTON,value:[o.pressed?m.ON:m.OFF],lifecycleState:o.pressed?f?n.Continued:n.Started:n.Ended})}),t.gamepad?.axes.length>2?e.inputState.set(s.axes,{type:i.TWODIM,value:[t.gamepad.axes[2],t.gamepad.axes[3]],lifecycleState:n.Started}):e.inputState.set(s.axes,{type:i.TWODIM,value:[t.gamepad.axes[0],t.gamepad.axes[1]],lifecycleState:n.Started})}}if(e.xrControllerModel)for(const r of u.enter())b(r)}}export{W as default};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWFJTeXN0ZW0uZGEwODZjYzQuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2VuZ2luZS9zcmMveHIvc3lzdGVtcy9YUlN5c3RlbS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzUkdCRW5jb2RpbmcgfSBmcm9tICd0aHJlZSdcbmltcG9ydCB7IEFzc2V0TG9hZGVyIH0gZnJvbSAnLi4vLi4vYXNzZXRzL2NsYXNzZXMvQXNzZXRMb2FkZXInXG5pbXBvcnQgeyBYUklucHV0U291cmNlQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vYXZhdGFyL2NvbXBvbmVudHMvWFJJbnB1dFNvdXJjZUNvbXBvbmVudCdcbmltcG9ydCB7IEJpbmFyeVZhbHVlIH0gZnJvbSAnLi4vLi4vY29tbW9uL2VudW1zL0JpbmFyeVZhbHVlJ1xuaW1wb3J0IHsgTGlmZWN5Y2xlVmFsdWUgfSBmcm9tICcuLi8uLi9jb21tb24vZW51bXMvTGlmZWN5Y2xlVmFsdWUnXG5pbXBvcnQgeyBFbmdpbmUgfSBmcm9tICcuLi8uLi9lY3MvY2xhc3Nlcy9FbmdpbmUnXG5pbXBvcnQgeyBFbmdpbmVFdmVudHMgfSBmcm9tICcuLi8uLi9lY3MvY2xhc3Nlcy9FbmdpbmVFdmVudHMnXG5pbXBvcnQgeyBTeXN0ZW0gfSBmcm9tICcuLi8uLi9lY3MvY2xhc3Nlcy9TeXN0ZW0nXG5pbXBvcnQgeyBXb3JsZCB9IGZyb20gJy4uLy4uL2Vjcy9jbGFzc2VzL1dvcmxkJ1xuaW1wb3J0IHsgZGVmaW5lUXVlcnkgfSBmcm9tICcuLi8uLi9lY3MvZnVuY3Rpb25zL0NvbXBvbmVudEZ1bmN0aW9ucydcbmltcG9ydCB7IElucHV0Q29tcG9uZW50IH0gZnJvbSAnLi4vLi4vaW5wdXQvY29tcG9uZW50cy9JbnB1dENvbXBvbmVudCdcbmltcG9ydCB7IExvY2FsSW5wdXRUYWdDb21wb25lbnQgfSBmcm9tICcuLi8uLi9pbnB1dC9jb21wb25lbnRzL0xvY2FsSW5wdXRUYWdDb21wb25lbnQnXG5pbXBvcnQgeyBJbnB1dFR5cGUgfSBmcm9tICcuLi8uLi9pbnB1dC9lbnVtcy9JbnB1dFR5cGUnXG5pbXBvcnQgeyBnYW1lcGFkTWFwcGluZyB9IGZyb20gJy4uLy4uL2lucHV0L2Z1bmN0aW9ucy9HYW1lcGFkSW5wdXQnXG5pbXBvcnQgeyBYUlJlZmVyZW5jZVNwYWNlVHlwZSB9IGZyb20gJy4uLy4uL2lucHV0L3R5cGVzL1dlYlhSJ1xuaW1wb3J0IHsgYWRkRGVmYXVsdENvbnRyb2xsZXJNb2RlbHMgfSBmcm9tICcuLi9mdW5jdGlvbnMvYWRkQ29udHJvbGxlck1vZGVscydcbmltcG9ydCB7IGVuZFhSLCBzdGFydFdlYlhSIH0gZnJvbSAnLi4vZnVuY3Rpb25zL1dlYlhSRnVuY3Rpb25zJ1xuXG4vKipcbiAqIFN5c3RlbSBmb3IgWFIgc2Vzc2lvbiBhbmQgaW5wdXQgaGFuZGxpbmdcbiAqIEBhdXRob3IgSm9zaCBGaWVsZCA8Z2l0aHViLmNvbS9oZXhhZmllbGQ+XG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gWFJTeXN0ZW0od29ybGQ6IFdvcmxkKTogUHJvbWlzZTxTeXN0ZW0+IHtcbiAgY29uc3QgcmVmZXJlbmNlU3BhY2VUeXBlOiBYUlJlZmVyZW5jZVNwYWNlVHlwZSA9ICdsb2NhbC1mbG9vcidcblxuICBjb25zdCBsb2NhbFhSQ29udHJvbGxlclF1ZXJ5ID0gZGVmaW5lUXVlcnkoW0lucHV0Q29tcG9uZW50LCBMb2NhbElucHV0VGFnQ29tcG9uZW50LCBYUklucHV0U291cmNlQ29tcG9uZW50XSlcblxuICAvLyBURU1QT1JBUlkgLSBwcmVjYWNoZSBjb250cm9sbGVyIG1vZGVsXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIHdoZW4gSUsgc3lzdGVtIGlzIGluXG4gIGF3YWl0IEFzc2V0TG9hZGVyLmxvYWRBc3luYyh7IHVybDogJy9tb2RlbHMvd2VieHIvY29udHJvbGxlcnMvdmFsdmVfY29udHJvbGxlcl9rbnVfMV8wX3JpZ2h0LmdsYicgfSlcbiAgLy8gQ2FjaGUgaGFuZCBtb2RlbHNcbiAgYXdhaXQgQXNzZXRMb2FkZXIubG9hZEFzeW5jKHsgdXJsOiAnL21vZGVscy93ZWJ4ci9jb250cm9sbGVycy9oYW5kcy9sZWZ0LmdsYicgfSlcbiAgYXdhaXQgQXNzZXRMb2FkZXIubG9hZEFzeW5jKHsgdXJsOiAnL21vZGVscy93ZWJ4ci9jb250cm9sbGVycy9oYW5kcy9yaWdodC5nbGInIH0pXG5cbiAgRW5naW5lRXZlbnRzLmluc3RhbmNlLmFkZEV2ZW50TGlzdGVuZXIoRW5naW5lRXZlbnRzLkVWRU5UUy5YUl9TVEFSVCwgYXN5bmMgKGV2OiBhbnkpID0+IHtcbiAgICBFbmdpbmUucmVuZGVyZXIub3V0cHV0RW5jb2RpbmcgPSBzUkdCRW5jb2RpbmdcbiAgICBjb25zdCBzZXNzaW9uSW5pdCA9IHsgb3B0aW9uYWxGZWF0dXJlczogW3JlZmVyZW5jZVNwYWNlVHlwZSwgJ2hhbmQtdHJhY2tpbmcnXSB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCAobmF2aWdhdG9yIGFzIGFueSkueHIucmVxdWVzdFNlc3Npb24oJ2ltbWVyc2l2ZS12cicsIHNlc3Npb25Jbml0KVxuXG4gICAgICBFbmdpbmUueHJTZXNzaW9uID0gc2Vzc2lvblxuICAgICAgRW5naW5lLnhyUmVuZGVyZXIuc2V0UmVmZXJlbmNlU3BhY2VUeXBlKHJlZmVyZW5jZVNwYWNlVHlwZSlcbiAgICAgIEVuZ2luZS54clJlbmRlcmVyLnNldFNlc3Npb24oc2Vzc2lvbilcbiAgICAgIEVuZ2luZUV2ZW50cy5pbnN0YW5jZS5kaXNwYXRjaEV2ZW50KHsgdHlwZTogRW5naW5lRXZlbnRzLkVWRU5UUy5YUl9TRVNTSU9OIH0pXG5cbiAgICAgIEVuZ2luZS54clJlbmRlcmVyLmdldENhbWVyYSgpLmxheWVycy5lbmFibGVBbGwoKVxuXG4gICAgICBFbmdpbmUueHJSZW5kZXJlci5hZGRFdmVudExpc3RlbmVyKCdzZXNzaW9uZW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBlbmRYUigpXG4gICAgICAgIEVuZ2luZUV2ZW50cy5pbnN0YW5jZS5kaXNwYXRjaEV2ZW50KHsgdHlwZTogRW5naW5lRXZlbnRzLkVWRU5UUy5YUl9FTkQgfSlcbiAgICAgIH0pXG5cbiAgICAgIHN0YXJ0V2ViWFIoKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdGYWlsZWQgdG8gY3JlYXRlIFhSIFNlc3Npb24nLCBlKVxuICAgIH1cbiAgfSlcblxuICByZXR1cm4gKCkgPT4ge1xuICAgIGlmIChFbmdpbmUueHJSZW5kZXJlcj8uaXNQcmVzZW50aW5nKSB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gRW5naW5lLnhyRnJhbWUuc2Vzc2lvblxuICAgICAgZm9yIChjb25zdCBzb3VyY2Ugb2Ygc2Vzc2lvbi5pbnB1dFNvdXJjZXMpIHtcbiAgICAgICAgaWYgKHNvdXJjZS5nYW1lcGFkKSB7XG4gICAgICAgICAgY29uc3QgbWFwcGluZyA9IGdhbWVwYWRNYXBwaW5nW3NvdXJjZS5nYW1lcGFkLm1hcHBpbmcgfHwgJ3hyLXN0YW5kYXJkJ11bc291cmNlLmhhbmRlZG5lc3NdXG4gICAgICAgICAgc291cmNlLmdhbWVwYWQ/LmJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETyA6IHN1cHBvcnQgYnV0dG9uLnRvdWNoZWQgYW5kIGJ1dHRvbi52YWx1ZVxuICAgICAgICAgICAgY29uc3QgcHJldiA9IEVuZ2luZS5wcmV2SW5wdXRTdGF0ZS5nZXQobWFwcGluZy5idXR0b25zW2luZGV4XSlcbiAgICAgICAgICAgIGlmICghcHJldiAmJiBidXR0b24ucHJlc3NlZCA9PSBmYWxzZSkgcmV0dXJuXG4gICAgICAgICAgICBjb25zdCBjb250aW51ZWQgPSBwcmV2Py52YWx1ZSAmJiBidXR0b24ucHJlc3NlZFxuICAgICAgICAgICAgRW5naW5lLmlucHV0U3RhdGUuc2V0KG1hcHBpbmcuYnV0dG9uc1tpbmRleF0sIHtcbiAgICAgICAgICAgICAgdHlwZTogSW5wdXRUeXBlLkJVVFRPTixcbiAgICAgICAgICAgICAgdmFsdWU6IFtidXR0b24ucHJlc3NlZCA/IEJpbmFyeVZhbHVlLk9OIDogQmluYXJ5VmFsdWUuT0ZGXSxcbiAgICAgICAgICAgICAgbGlmZWN5Y2xlU3RhdGU6IGJ1dHRvbi5wcmVzc2VkXG4gICAgICAgICAgICAgICAgPyBjb250aW51ZWRcbiAgICAgICAgICAgICAgICAgID8gTGlmZWN5Y2xlVmFsdWUuQ29udGludWVkXG4gICAgICAgICAgICAgICAgICA6IExpZmVjeWNsZVZhbHVlLlN0YXJ0ZWRcbiAgICAgICAgICAgICAgICA6IExpZmVjeWNsZVZhbHVlLkVuZGVkXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pXG4gICAgICAgICAgaWYgKHNvdXJjZS5nYW1lcGFkPy5heGVzLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIEVuZ2luZS5pbnB1dFN0YXRlLnNldChtYXBwaW5nLmF4ZXMsIHtcbiAgICAgICAgICAgICAgdHlwZTogSW5wdXRUeXBlLlRXT0RJTSxcbiAgICAgICAgICAgICAgdmFsdWU6IFtzb3VyY2UuZ2FtZXBhZC5heGVzWzJdLCBzb3VyY2UuZ2FtZXBhZC5heGVzWzNdXSxcbiAgICAgICAgICAgICAgbGlmZWN5Y2xlU3RhdGU6IExpZmVjeWNsZVZhbHVlLlN0YXJ0ZWRcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIEVuZ2luZS5pbnB1dFN0YXRlLnNldChtYXBwaW5nLmF4ZXMsIHtcbiAgICAgICAgICAgICAgdHlwZTogSW5wdXRUeXBlLlRXT0RJTSxcbiAgICAgICAgICAgICAgdmFsdWU6IFtzb3VyY2UuZ2FtZXBhZC5heGVzWzBdLCBzb3VyY2UuZ2FtZXBhZC5heGVzWzFdXSxcbiAgICAgICAgICAgICAgbGlmZWN5Y2xlU3RhdGU6IExpZmVjeWNsZVZhbHVlLlN0YXJ0ZWRcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKEVuZ2luZS54ckNvbnRyb2xsZXJNb2RlbCkge1xuICAgICAgZm9yIChjb25zdCBlbnRpdHkgb2YgbG9jYWxYUkNvbnRyb2xsZXJRdWVyeS5lbnRlcigpKSB7XG4gICAgICAgIGFkZERlZmF1bHRDb250cm9sbGVyTW9kZWxzKGVudGl0eSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gVE9ETzogYWRkIGFuZCByZW1vdmUgY29udHJvbGxlciBtb2RlbHMgZnJvbSBncmlwc1xufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJpcEJBdUJ1QyxFQUErQixNQUM5RCxHQUEyQyxjQUUzQyxFQUF5QixFQUFZLENBQUMsRUFBZ0IsRUFBd0IsZ0JBSTlFLEdBQVksVUFBVSxDQUFFLElBQUssc0VBRTdCLEdBQVksVUFBVSxDQUFFLElBQUssa0RBQzdCLEdBQVksVUFBVSxDQUFFLElBQUssZ0RBRXRCLFNBQVMsaUJBQWlCLEVBQWEsT0FBTyxTQUFVLEtBQU8sSUFBWSxHQUMvRSxTQUFTLGVBQWlCLE9BQzNCLEdBQWMsQ0FBRSxpQkFBa0IsQ0FBQyxFQUFvQixxQkFDekQsTUFDSSxHQUFVLEtBQU8sV0FBa0IsR0FBRyxlQUFlLGVBQWdCLEtBRXBFLFVBQVksSUFDWixXQUFXLHNCQUFzQixLQUNqQyxXQUFXLFdBQVcsS0FDaEIsU0FBUyxjQUFjLENBQUUsS0FBTSxFQUFhLE9BQU8sZUFFekQsV0FBVyxZQUFZLE9BQU8sY0FFOUIsV0FBVyxpQkFBaUIsYUFBYyxTQUFZLE9BRTlDLFNBQVMsY0FBYyxDQUFFLEtBQU0sRUFBYSxPQUFPLHFCQUkzRCxXQUNDLElBQUksOEJBQStCLE1BSXhDLElBQU0sSUFDUCxFQUFPLFlBQVksYUFBYyxNQUM3QixHQUFVLEVBQU8sUUFBUSxpQkFDcEIsS0FBVSxHQUFRLGdCQUN2QixFQUFPLFFBQVMsTUFDWixHQUFVLEVBQWUsRUFBTyxRQUFRLFNBQVcsZUFBZSxFQUFPLGNBQ3hFLFNBQVMsUUFBUSxRQUFRLENBQUMsRUFBUSxJQUFVLE1BRTNDLEdBQU8sRUFBTyxlQUFlLElBQUksRUFBUSxRQUFRLE9BQ25ELENBQUMsR0FBUSxFQUFPLFNBQVcsZUFDekIsR0FBWSxHQUFNLE9BQVMsRUFBTyxVQUNqQyxXQUFXLElBQUksRUFBUSxRQUFRLEdBQVEsQ0FDNUMsS0FBTSxFQUFVLE9BQ2hCLE1BQU8sQ0FBQyxFQUFPLFFBQVUsRUFBWSxHQUFLLEVBQVksS0FDdEQsZUFBZ0IsRUFBTyxRQUNuQixFQUNFLEVBQWUsVUFDZixFQUFlLFFBQ2pCLEVBQWUsVUFHbkIsRUFBTyxTQUFTLEtBQUssT0FBUyxJQUN6QixXQUFXLElBQUksRUFBUSxLQUFNLENBQ2xDLEtBQU0sRUFBVSxPQUNoQixNQUFPLENBQUMsRUFBTyxRQUFRLEtBQUssR0FBSSxFQUFPLFFBQVEsS0FBSyxJQUNwRCxlQUFnQixFQUFlLFlBRzFCLFdBQVcsSUFBSSxFQUFRLEtBQU0sQ0FDbEMsS0FBTSxFQUFVLE9BQ2hCLE1BQU8sQ0FBQyxFQUFPLFFBQVEsS0FBSyxHQUFJLEVBQU8sUUFBUSxLQUFLLElBQ3BELGVBQWdCLEVBQWUsY0FPckMsRUFBTywyQkFDRSxLQUFVLEdBQXVCLFVBQ2YifQ==
